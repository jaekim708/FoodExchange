<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
  <meta name="generator" content="Bluefish 2.2.5" >
  <meta>

  <title>My Parse App</title>
  <meta name="description" content="My Parse App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/reset.css" type="text/css">
  <link rel="stylesheet" href="css/styles.css" type="text/css">
  <script type="text/javascript" src=
  "http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">
</script>
  <script type="text/javascript" src=
  "http://www.parsecdn.com/js/parse-1.3.4.min.js">
</script>
  <style type="text/css">
div.c1 {display:none}
  </style>
</head>

<body>
  <div id="main">
    <h1>List of food below</h1>

    <form method="link" action="host.html">
      <p><input type="submit" value="Selling food"></p>
    </form>

		
	<form action="">
	<input type="checkbox" id="dFree" onclick="getList()"> Dairy-Free<br>
	<input type="checkbox" id="gFree" onclick="getList()"> Gluten-Free<br>
	<input type="checkbox" id="pFree" onclick="getList()"> Peanut-Free 
	</form>
	
	<ol id="hosts"></ol>

  </div>
  <script type="text/javascript">
  		Parse.initialize("TnvJePY5vT2oSuP3VgWsO8OTWwZO2rMX0ZdwvRIh", "moibVX5koKKKLKGvMmavEGVDkvZ3lVfWw9x23cIt");
		var dFree = document.getElementById("dFree").checked;
		var gFree = document.getElementById("gFree").checked;
		var pFree = document.getElementById("pFree").checked;
		getList(dFree, gFree, pFree);
		function getList(dFree, gFree, pFree){	
			var Hosts = Parse.Object.extend("Hosts");
			var query = new Parse.Query(Hosts);
			query.find({
				success: function(results){
					results.sort(compare);		
					var hosts =	document.getElementById('hosts');
	  				for(var i = 0; i < results.length; i++){
	  					if((dFree && !results[i].get("IsDairyFree")) ||
	  						(gFree && !results[i].get("IsGlutenFree")) ||
	  						(pFree && !results[i].get("IsNutFree")))
	  						continue;
						var entry = document.createElement('li');
						entry.appendChild(document.createTextNode(results[i].get("HostName")));
						hosts.appendChild(entry);
	  				}
				},
				error: function(error){
  	  	 			document.write("ERROR: " + error.message);
				}
			});
	  	}
		function compare(a, b){
			if(a.DistanceToMe < b.DistanceToMe)
				return -1;
			if(a.DistanceToMe > b.DistanceToMe)
				return 1;
			return 0;			
		}
 </script>
</body>
</html>
