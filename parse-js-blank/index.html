<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
  <meta name="generator" content="Bluefish 2.2.5" >
  <meta>

  <title>My Parse App</title>
  <meta name="description" content="My Parse App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/reset.css" type="text/css">
  <link rel="stylesheet" href="css/styles.css" type="text/css">
  <script type="text/javascript" src=
  "http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">
</script>
  <script type="text/javascript" src=
  "http://www.parsecdn.com/js/parse-1.3.4.min.js">
</script>
  <style type="text/css">
div.c1 {display:none}
  </style>
</head>


<body>

<style type="text/css">
body {background-color:ffffff;background-image:url(http://www.cohabitaire.com/wp-content/uploads/2013/06/Cohabitaire-RawFood-05.jpg);background-repeat:no-repeat;background-position:bottom center;background-attachment:fixed;}
h1{text-align:center;font-family:Cursive;color:000000;}
p {text-align:center;font-family:Cursive;font-size:18px;font-style:normal;font-weight:normal;font-variant:small-caps;color:000000;}

</style>

<h1>We find the nearest available food for you! =)<h1>

<p>too lazy to make your own fucking food? we got you man.<p> <p style="text-align:right;">Please <a href="file:///C:/Users/y1000780/TACL/parse-js-blank/login.html">LogIn</a>.</p>
    <p style="text-align:right;">List of food below</p>

    <form method="link" action="host.html">
      <p style="text-align:right;"><input type="submit" value="Selling food"></p>
    </form>

		
	<form action=""><p style="text-align:right;">
	<input type="checkbox" id="dFree" onclick="getList()"> Dairy-Free<br>
	<input type="checkbox" id="gFree" onclick="getList()"> Gluten-Free<br>
	<input type="checkbox" id="pFree" onclick="getList()"> Peanut-Free
	</form>
	
	<ul style="list-style: none;"><li id="hosts"></li>

  </div>
  <script type="text/javascript">
  		Parse.initialize("TnvJePY5vT2oSuP3VgWsO8OTWwZO2rMX0ZdwvRIh", "moibVX5koKKKLKGvMmavEGVDkvZ3lVfWw9x23cIt");
		getList();
		function getList(){		
			[dFree, gFree, pFree] = getButtonStatus();
			var Hosts = Parse.Object.extend("Hosts");
			var query = new Parse.Query(Hosts);
			query.find({
				success: function(results){
					var hosts =	document.getElementById('hosts');
					while(hosts.hasChildNodes())
						hosts.removeChild(hosts.childNodes[0]);
					results.sort(compare);		
	  				for(var i = 0; i < results.length; i++){
	  					if((dFree && !results[i].get("IsDairyFree")) ||
	  						(gFree && !results[i].get("IsGlutenFree")) ||
	  						(pFree && !results[i].get("IsNutFree")))
	  						continue;
						var entry = document.createElement('li');
						entry.appendChild(document.createTextNode(results[i].get("HostName")));
						hosts.appendChild(entry);
	  				}
				},
				error: function(error){
  	  	 			document.write("ERROR: " + error.message);
				}
			});
	  	}
		function compare(a, b){
			if(a.DistanceToMe < b.DistanceToMe)
				return -1;
			if(a.DistanceToMe > b.DistanceToMe)
				return 1;
			return 0;			
		}
		function getButtonStatus(){		
			var dFree = document.getElementById("dFree").checked;
			var gFree = document.getElementById("gFree").checked;
			var pFree = document.getElementById("pFree").checked;
			return[dFree, gFree, pFree];
		}
 </script>
</body>
</html>
